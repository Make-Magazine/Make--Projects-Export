{"device":"Arduino","url":"http:\/\/makeprojects.com\/Project\/Using+an+Arduino+to+Process+Fire+Dept.+Tones\/2299\/1","guide":{"author":{"text":"Justin","userid":10580},"categories":["Arduino","Circuits"],"conclusion":"","difficulty":"Moderate","documents":[{"text":"Sine_Wave_Frequency_V2.pdf","url":"http:\/\/make-documents.s3.amazonaws.com\/5UugVVlRoD5mlYWA.pdf","documentid":298}],"flags":[{"title":"User-Contributed Project","flagid":"GUIDE_USER_CONTRIBUTED","text":"This project guide is not managed by MAKE staff."}],"guideid":2299,"image":{"imageid":45577,"text":"http:\/\/guide-images.makeprojects.org\/igi\/EHWjluBZYodGijKX"},"introduction":"<p>I'm on the volunteer fire dept. in my town and as such, like to keep tabs on when neighboring towns are dispatched. I came up with the idea to make a large map of my area and put an LED in each town that would light up when they get called out. To do this though i would have to find someway to discriminate between towns, and since multiple towns use the same radio frequency, I couldn't just cross-reference the frequency with the town. Fortunately though every town has a unique tone sent out just prior  to the dispatch. It is this tone that i need to look at, process and then match up with its town.<\/p>\n\n<p>Seeing as this is meant to run constantly , a micro-contoller is the clear choice, and what better than an arduino. Unfortunately, Arduinos don't have the capability to process a sine wave by themselves, so i needed to give it a little help...<\/p>","introduction_rendered":"<p>I'm on the volunteer fire dept. in my town and as such, like to keep tabs on when neighboring towns are dispatched. I came up with the idea to make a large map of my area and put an LED in each town that would light up when they get called out. To do this though i would have to find someway to discriminate between towns, and since multiple towns use the same radio frequency, I couldn't just cross-reference the frequency with the town. Fortunately though every town has a unique tone sent out just prior  to the dispatch. It is this tone that i need to look at, process and then match up with its town.<\/p>\n\n<p>Seeing as this is meant to run constantly , a micro-contoller is the clear choice, and what better than an arduino. Unfortunately, Arduinos don't have the capability to process a sine wave by themselves, so i needed to give it a little help...<\/p><div class=\"parts\"><strong>Relevant parts<\/strong><ul><li><a href=\"http:\/\/www.makershed.com\/ProductDetails.asp?ProductCode=MKSP4\">Arduino Uno<\/a><\/li><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2103798\">Perfboard<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/LM324_op-amp\">LM324 op-amp<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/2n2222\">2n2222<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/LEDs\">LEDs<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Resistors_1k%CE%A9\">Resistors, 1k\u03a9<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/100_Ohm_Resistor\">100 Ohm Resistor<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/220_ohm_resistor\">220 ohm resistor<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/50k_resistor\">50k resistor<\/a><\/li><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2036270\">Diode<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/470_ohm_resistor\">470 ohm resistor<\/a><\/li><\/ul><\/div><div class=\"tools\"><strong>Tools<\/strong><ul><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=3086619\">Soldering iron, with solder<\/a><\/li><\/ul><\/div>","locale":"en","parts":[{"text":"Arduino Uno","notes":"","url":"http:\/\/www.makershed.com\/ProductDetails.asp?ProductCode=MKSP4","thumbnail":""},{"text":"Perfboard","notes":"","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2103798","thumbnail":""},{"text":"LM324 op-amp","notes":"","url":"http:\/\/makeprojects.com\/Item\/LM324_op-amp","thumbnail":""},{"text":"2n2222","notes":"","url":"http:\/\/makeprojects.com\/Item\/2n2222","thumbnail":""},{"text":"LEDs","notes":"","url":"http:\/\/makeprojects.com\/Item\/LEDs","thumbnail":""},{"text":"Resistors, 1k\u03a9","notes":"","url":"http:\/\/makeprojects.com\/Item\/Resistors_1k%CE%A9","thumbnail":""},{"text":"100 Ohm Resistor","notes":"","url":"http:\/\/makeprojects.com\/Item\/100_Ohm_Resistor","thumbnail":""},{"text":"220 ohm resistor","notes":"","url":"http:\/\/makeprojects.com\/Item\/220_ohm_resistor","thumbnail":""},{"text":"50k resistor","notes":"","url":"http:\/\/makeprojects.com\/Item\/50k_resistor","thumbnail":""},{"text":"Diode","notes":"","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2036270","thumbnail":""},{"text":"470 ohm resistor","notes":"","url":"http:\/\/makeprojects.com\/Item\/470_ohm_resistor","thumbnail":""}],"prereqs":[],"steps":[{"title":"","lines":[{"text":"To give the Arduino the capability to process the sine wave, i first converted the sine wave (blue) into a square wave (yellow), and then filtered out any negative voltages. this left a high pulse (tan) every time time the sine wave was negative","text_raw":"To give the Arduino the capability to process the sine wave, i first converted the sine wave (blue) into a square wave (yellow), and then filtered out any negative voltages. this left a high pulse (tan) every time time the sine wave was negative","bullet":"black","level":0},{"text":"This graph was generated using CircuitLab.com 's amazing (and free) circuit simulation.","text_raw":"This graph was generated using CircuitLab.com 's amazing (and free) circuit simulation.","bullet":"black","level":0}],"object":null,"images":[{"imageid":45577,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/EHWjluBZYodGijKX"}],"number":1},{"title":"","lines":[{"text":"The actual circuit is pretty self explanatory, but I'll go through it anyways.","text_raw":"The actual circuit is pretty self explanatory, but I'll go through it anyways.","bullet":"black","level":0},{"text":"You feed the op-amp's positive with the sine wave, and compare it to a low reference voltage to produce the square wave.","text_raw":"You feed the op-amp's positive with the sine wave, and compare it to a low reference voltage to produce the square wave.","bullet":"black","level":0},{"text":"originally i compared the sine wave to ground, but that proved too sensitive and any noise on the line would set it off. A voltage divider such as this one sets a minimum level (in this case volume level).","text_raw":"originally i compared the sine wave to ground, but that proved too sensitive and any noise on the line would set it off. A voltage divider such as this one sets a minimum level (in this case volume level).","bullet":"black","level":1},{"text":"Once you have the square wave, a simple diode will filter out the negative voltages, leaving just high pulses.","text_raw":"Once you have the square wave, a simple diode will filter out the negative voltages, leaving just high pulses.","bullet":"black","level":0},{"text":"sending the high pulses to the base of a transistor will draw the connector, and the arduino pin it is connected to, to ground.","text_raw":"sending the high pulses to the base of a transistor will draw the connector, and the arduino pin it is connected to, to ground.","bullet":"black","level":0},{"text":"Not shown here is a 'pull up' resistor connected between the arduino's pin and +5v. this ensures that the pin is always 'HIGH' unless we WANT it to be 'LOW'","text_raw":"Not shown here is a 'pull up' resistor connected between the arduino's pin and +5v. this ensures that the pin is always 'HIGH' unless we WANT it to be 'LOW'","bullet":"black","level":0},{"text":"Circuit diagram is also from Circuitlab.com","text_raw":"Circuit diagram is also from Circuitlab.com","bullet":"black","level":0}],"object":null,"images":[{"imageid":45575,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/qlb2ZEP6pSWEFMn2"}],"number":2},{"title":"","lines":[{"text":"Unfortunately I didn't have the foresight to take any pictures of it breadboarded but this how my perf-board came out.","text_raw":"Unfortunately I didn't have the foresight to take any pictures of it breadboarded but this how my perf-board came out.","bullet":"black","level":0},{"text":"The LED is connected between the collector and +5v through a 470 ohm resistor. it lights up with every high pulse off the op-amp and also serves as a pull up for the arduino pin.","text_raw":"The LED is connected between the collector and +5v through a 470 ohm resistor. it lights up with every high pulse off the op-amp and also serves as a pull up for the arduino pin.","bullet":"black","level":0},{"text":"Obviously 750 times a second is too fast for us to see, so it just looks like it is lit up. Its a good indicator for when the level clears the reference voltage.","text_raw":"Obviously 750 times a second is too fast for us to see, so it just looks like it is lit up. Its a good indicator for when the level clears the reference voltage.","bullet":"black","level":1}],"object":null,"images":[{"imageid":45578,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/oThxL1KhVAgIZhUi"},{"imageid":45579,"orderby":2,"text":"http:\/\/guide-images.makeprojects.org\/igi\/yyOtJhKQXm1FLCRI"},{"imageid":45581,"orderby":3,"text":"http:\/\/guide-images.makeprojects.org\/igi\/Yy32OjyiVFx2jaQY"}],"number":3},{"title":"","lines":[{"text":"Now that we have 'low pulses' (drawing the arduino's pin to ground) it's just a matter of coding.","text_raw":"Now that we have 'low pulses' (drawing the arduino's pin to ground) it's just a matter of coding.","bullet":"black","level":0},{"text":"After some research i found the 'AttachInterupt' command. details are here: <a href=\"http:\/\/arduino.cc\/en\/Reference\/AttachInterrupt\" rel=\"nofollow\" title=\"http:\/\/arduino.cc\/en\/Reference\/AttachInterrupt\">http:\/\/arduino.cc\/en\/Reference\/AttachInt...<\/a>","text_raw":"After some research i found the 'AttachInterupt' command. details are here: http:\/\/arduino.cc\/en\/Reference\/AttachInterrupt","bullet":"black","level":0},{"text":"The basic premise of my code is to find how long it take for 100 pulses to 'fire'. then you can do some math to find the period of the sine wave and from there it is pretty simple to find the frequency.","text_raw":"The basic premise of my code is to find how long it take for 100 pulses to 'fire'. then you can do some math to find the period of the sine wave and from there it is pretty simple to find the frequency.","bullet":"black","level":0},{"text":"The code is attached in a .pdf file. For the most part the coding is complete. To add new towns all you have to do is add their information into the 3 arrays.","text_raw":"The code is attached in a .pdf file. For the most part the coding is complete. To add new towns all you have to do is add their information into the 3 arrays.","bullet":"black","level":0},{"text":"Make sure that for the three arrays, each town has its own index. I.E. 'Windsor' gets index 0 for frequency index 0, for name, and index 0 for LEDpin.","text_raw":"Make sure that for the three arrays, each town has its own index. I.E. 'Windsor' gets index 0 for frequency index 0, for name, and index 0 for LEDpin.","bullet":"black","level":1}],"object":null,"images":[],"number":4}],"subject":"","summary":"In my area, multiple towns use the same radio frequency to dispatch their fire departments. To discriminate between towns you must look at the tone transmitted right before the dispatch. This project lets me process the tone and determine which town it is","time_required":"","title":"Using an Arduino to Process Fire Dept. Tones","tools":[{"text":"Soldering iron, with solder","notes":"","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=3086619","thumbnail":""}],"type":"project"},"guideid":"2299"}