{"device":"Gadgets","url":"http:\/\/makeprojects.com\/Project\/Key-Card+Door+Lock\/3141\/1","guide":{"author":{"text":"Charles Platt","userid":1423},"categories":["Gadgets"],"conclusion":"<p><strong>This project first appeared in <a href=\"http:\/\/makezine.com\/33\">MAKE Volume 33<\/a>, page 92.<\/strong><\/p>","difficulty":"Moderate","documents":[],"flags":[{"title":"From MAKE Magazine","flagid":"FROM_MAKE","text":"This project first appeared on the pages of MAKE magazine."},{"title":"Featured Guide","flagid":"GUIDE_STARRED","text":"This project has been found to be exceptionally cool by the MAKE staff."}],"guideid":3141,"image":{"imageid":56356,"text":"http:\/\/guide-images.makeprojects.org\/igi\/A51ErIAOANrJwxHo"},"introduction":"<p>Almost anyone can learn to pick a typical door lock. The most common method is to jiggle the tumblers by inserting a tool known as a \u201crake,\u201d while applying turning force with a tension wrench. When the tumblers are aligned, the cylinder rotates and you can walk right in.<\/p>\n\n<p>When I first started thinking about a pick-proof electronic lock, I imagined a totally automated system using a key card and a motor that would pull a deadbolt aside. However, a motor that was powerful enough to overcome the likely friction would require either 115V AC (vulnerable to power outages) or a substantial battery.<\/p>\n\n<p>It would be cheaper and simpler to use an off-the-shelf deadbolt that\u2019s moved manually by turning an external knob. I could block or unblock the movement of the deadbolt using a small, low-power DC gearmotor to turn a lever (see Step 1).<\/p>\n\n<p>For the key card, I imagined a plastic rectangle punched with a unique pattern of holes. The card would slide into a slot with a light source to shine through the holes to phototransistor<wbr \/>s beneath. Additional electronics would decide whether the pattern was correct. If I needed to rekey the lock, I could make a new card with a different pattern, and reprogram the electronics to match.<\/p>\n\n<p>The word \u201creprogram\u201d suggested I\u2019d need a microcontroller to complete this project. Or would I? Maybe a set of switches could do the job more simply and cheaply. The first step toward figuring this out was to review the way in which phototransistor<wbr \/>s generally behave.<\/p>","introduction_rendered":"<p>Almost anyone can learn to pick a typical door lock. The most common method is to jiggle the tumblers by inserting a tool known as a \u201crake,\u201d while applying turning force with a tension wrench. When the tumblers are aligned, the cylinder rotates and you can walk right in.<\/p>\n\n<p>When I first started thinking about a pick-proof electronic lock, I imagined a totally automated system using a key card and a motor that would pull a deadbolt aside. However, a motor that was powerful enough to overcome the likely friction would require either 115V AC (vulnerable to power outages) or a substantial battery.<\/p>\n\n<p>It would be cheaper and simpler to use an off-the-shelf deadbolt that\u2019s moved manually by turning an external knob. I could block or unblock the movement of the deadbolt using a small, low-power DC gearmotor to turn a lever (see Step 1).<\/p>\n\n<p>For the key card, I imagined a plastic rectangle punched with a unique pattern of holes. The card would slide into a slot with a light source to shine through the holes to phototransistor<wbr \/>s beneath. Additional electronics would decide whether the pattern was correct. If I needed to rekey the lock, I could make a new card with a different pattern, and reprogram the electronics to match.<\/p>\n\n<p>The word \u201creprogram\u201d suggested I\u2019d need a microcontroller to complete this project. Or would I? Maybe a set of switches could do the job more simply and cheaply. The first step toward figuring this out was to review the way in which phototransistor<wbr \/>s generally behave.<\/p><div class=\"parts\"><strong>Relevant parts<\/strong><ul><li><a href=\"http:\/\/makeprojects.com\/Item\/Phototransistors_visible_spectrum\">Phototransistors, visible spectrum<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/LEDs_white_water-clear\">LEDs, white, water-clear<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Slide_switches_subminiature_DPDT\">Slide switches, subminiature DPDT<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Toggle_switch_DPDT_centeroff_momentary_minimum_3A\">Toggle switch, DPDT, centeroff momentary, minimum 3A<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Resistor_arrays_bussed_5.6K\">Resistor arrays, bussed, 5.6K<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Logic_chip_triple_3-input_AND_gates_type_74HC11\">Logic chip, triple 3-input AND gates, type 74HC11<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Darlington_transistor_8A_type_2N6043\">Darlington transistor, 8A, type 2N6043<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Mini_lever_snap_switches_SPDT_5A\">Mini lever snap switches, SPDT, 5A<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Diodes_general_purpose_3A\">Diodes, general purpose, 3A<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Voltage_regulator_5V_type_LM7805\">Voltage regulator, 5V, type LM7805<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Capacitors_multilayer_ceramic\">Capacitors, multilayer ceramic<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Gearmotor_9V_or_12V_DC_minimum_10rpm\">Gearmotor, 9V or 12V DC, minimum 10rpm<\/a><\/li><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=3825542\">9V battery<\/a><\/li><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2734155\">Breadboard<\/a><\/li><li><a href=\"http:\/\/www.radioshack.com\/product\/index.jsp?productId=12165717\">Jumper wires<\/a><\/li><\/ul><\/div><div class=\"tools\"><strong>Tools<\/strong><ul><li><a href=\"http:\/\/makeprojects.com\/Item\/Multimeter_and_test_leads\">Multimeter and test leads<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Soldering_iron_and_solder\">Soldering iron and solder<\/a><\/li><li><a href=\"http:\/\/makeprojects.com\/Item\/Wire_cutters_and_strippers\">Wire cutters and strippers<\/a><\/li><\/ul><\/div>","locale":"en","parts":[{"text":"Phototransistors, visible spectrum","notes":"Everlight part #PT334- 6C or RadioShack #55053303","url":"http:\/\/makeprojects.com\/Item\/Phototransistors_visible_spectrum","thumbnail":""},{"text":"LEDs, white, water-clear","notes":"typical 3.3V forward voltage, minimum, 5,000mcd with 30\u00b0 dispersion; Kingbright #WP7104VW1C or RadioShack #55050632","url":"http:\/\/makeprojects.com\/Item\/LEDs_white_water-clear","thumbnail":""},{"text":"Slide switches, subminiature DPDT","notes":"C&amp;K #OS202013 MT5QN1","url":"http:\/\/makeprojects.com\/Item\/Slide_switches_subminiature_DPDT","thumbnail":""},{"text":"Toggle switch, DPDT, centeroff momentary, minimum 3A","notes":"Mountain Switch #108-0005-EVX","url":"http:\/\/makeprojects.com\/Item\/Toggle_switch_DPDT_centeroff_momentary_minimum_3A","thumbnail":""},{"text":"Resistor arrays, bussed, 5.6K","notes":"Xicon #265-5.6K-RC","url":"http:\/\/makeprojects.com\/Item\/Resistor_arrays_bussed_5.6K","thumbnail":""},{"text":"Logic chip, triple 3-input AND gates, type 74HC11","notes":"Texas Instruments #SN74HC11N","url":"http:\/\/makeprojects.com\/Item\/Logic_chip_triple_3-input_AND_gates_type_74HC11","thumbnail":""},{"text":"Darlington transistor, 8A, type 2N6043","notes":"On Semiconductor #2N6043G","url":"http:\/\/makeprojects.com\/Item\/Darlington_transistor_8A_type_2N6043","thumbnail":""},{"text":"Mini lever snap switches, SPDT, 5A","notes":"maximum 20g operating force, Mountain Switch #101-1206-EV","url":"http:\/\/makeprojects.com\/Item\/Mini_lever_snap_switches_SPDT_5A","thumbnail":""},{"text":"Diodes, general purpose, 3A","notes":"Vishay #SRP300G-E3\/54","url":"http:\/\/makeprojects.com\/Item\/Diodes_general_purpose_3A","thumbnail":""},{"text":"Voltage regulator, 5V, type LM7805","notes":"Fairchild Semiconductor #LM7805CT or RadioShack #276-1770 \u00bb Capacitors,","url":"http:\/\/makeprojects.com\/Item\/Voltage_regulator_5V_type_LM7805","thumbnail":""},{"text":"Capacitors, multilayer ceramic","notes":"For smoothing the 5V output","url":"http:\/\/makeprojects.com\/Item\/Capacitors_multilayer_ceramic","thumbnail":""},{"text":"Gearmotor, 9V or 12V DC, minimum 10rpm","notes":"ServoCity #RZ12-300-10RPM or check eBay for substitutes","url":"http:\/\/makeprojects.com\/Item\/Gearmotor_9V_or_12V_DC_minimum_10rpm","thumbnail":""},{"text":"9V battery","notes":"","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=3825542","thumbnail":""},{"text":"Breadboard","notes":"Optional, recommended for testing","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=2734155","thumbnail":""},{"text":"Jumper wires","notes":"Optional, recommended for testing","url":"http:\/\/www.radioshack.com\/product\/index.jsp?productId=12165717","thumbnail":""}],"prereqs":[],"steps":[{"title":"","lines":[{"text":"In this simplified rendering, a deadbolt (blue) is turned by an external knob (gray). The sliding shaft (red) is either blocked or freed by a lever (yellow) driven by a motor (purple) mounted inside the door.","text_raw":"In this simplified rendering, a deadbolt (blue) is turned by an external knob (gray). The sliding shaft (red) is either blocked or freed by a lever (yellow) driven by a motor (purple) mounted inside the door.","bullet":"black","level":0},{"text":"Limit switches (green) stop the motor when the lever reaches either end of its travel.","text_raw":"Limit switches (green) stop the motor when the lever reaches either end of its travel.","bullet":"black","level":0},{"text":"A third switch beneath the sliding shaft shuts down power when the deadbolt retracts, to prevent the motor from fouling it and burning out.","text_raw":"A third switch beneath the sliding shaft shuts down power when the deadbolt retracts, to prevent the motor from fouling it and burning out.","bullet":"black","level":0},{"text":"A fixed block (gray) resists the force transmitted through the lever if someone tries to jimmy the closed lock.","text_raw":"A fixed block (gray) resists the force transmitted through the lever if someone tries to jimmy the closed lock.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57163,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/HkAQtyQXfpEWxM3x"}],"number":1},{"title":"Phototransistors Basics","lines":[{"text":"In the first image, the phototransistor is the circle with arrows suggesting incoming light. When the light is off, the phototransistor allows only a tiny leakage current between emitter and collector, and the voltage between point X and ground is almost zero.","text_raw":"In the first image, the phototransistor is the circle with arrows suggesting incoming light. When the light is off, the phototransistor allows only a tiny leakage current between emitter and collector, and the voltage between point X and ground is almost zero.","bullet":"black","level":0},{"text":"As the light increases, the phototransistor junction becomes saturated, just like an NPN transistor when the base is highly biased. The effective internal resistance drops, and the voltage at point X rises close to the supply voltage (assuming any electronics attached to X have high impedance).","text_raw":"As the light increases, the phototransistor junction becomes saturated, just like an NPN transistor when the base is highly biased. The effective internal resistance drops, and the voltage at point X rises close to the supply voltage (assuming any electronics attached to X have high impedance).","bullet":"black","level":0},{"text":"I found a 5.6K resistor worked well with the phototransistor I chose for this project.","text_raw":"I found a 5.6K resistor worked well with the phototransistor I chose for this project.","bullet":"black","level":0},{"text":"If the positions of the phototransistor and the resistor are reversed, the outcome is too. In the second image, when the phototransistor is dark and blocks current, the voltage at X is high. When light shines on the phototransistor, the voltage at X goes low.","text_raw":"If the positions of the phototransistor and the resistor are reversed, the outcome is too. In the second image, when the phototransistor is dark and blocks current, the voltage at X is high. When light shines on the phototransistor, the voltage at X goes low.","bullet":"black","level":0},{"text":"So, depending on wiring, a phototransistor can give a high output either in the light (first image) or in the dark (second image). Thus, if phototransistors are wired as in image 1 to match the holes in a key card, and in image 2 to match the blocked areas of the card, all their outputs will go high when the card\u2019s pattern is correct.","text_raw":"So, depending on wiring, a phototransistor can give a high output either in the light (first image) or in the dark (second image). Thus, if phototransistors are wired as in image 1 to match the holes in a key card, and in image 2 to match the blocked areas of the card, all their outputs will go high when the card\u2019s pattern is correct.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57161,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/VpGXbKZmVShjGCUa"},{"imageid":57162,"orderby":2,"text":"http:\/\/guide-images.makeprojects.org\/igi\/NwACIOPjsImRCpGX"}],"number":2},{"title":"","lines":[{"text":"This can be verified by ANDing all the phototransistor states via a logic chip, because an AND gate only outputs high if all its inputs are high.","text_raw":"This can be verified by ANDing all the phototransistor states via a logic chip, because an AND gate only outputs high if all its inputs are high.","bullet":"black","level":0},{"text":"A hardwired array of phototransistors is not reprogrammable, but I saw that a DPDT switch could solve the problem. In its \u201cup\u201d position the switch emulates the circuit in Step 2's first image. In its \u201cdown\u201d position the switch emulates the circuit in Step 2's second image.","text_raw":"A hardwired array of phototransistors is not reprogrammable, but I saw that a DPDT switch could solve the problem. In its \u201cup\u201d position the switch emulates the circuit in Step 2's first image. In its \u201cdown\u201d position the switch emulates the circuit in Step 2's second image.","bullet":"black","level":0},{"text":"If the key card pattern is changed, the switch positions are changed to match.","text_raw":"If the key card pattern is changed, the switch positions are changed to match.","bullet":"black","level":0},{"text":"Phototransistors and subminiature slide switches are cheap, so the electronics for this project shouldn\u2019t cost more than $20. The motor and deadbolt are extra, but I found small DC motors on eBay for $5 or $6 each.","text_raw":"Phototransistors and subminiature slide switches are cheap, so the electronics for this project shouldn\u2019t cost more than $20. The motor and deadbolt are extra, but I found small DC motors on eBay for $5 or $6 each.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57168,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/Hj12TCiptGZbSVfA"}],"number":3},{"title":"Combinations","lines":[{"text":"Now to decide how many phototransistors to use. Sixteen in a 4\u00d74 grid would allow 65,536 possible combinations, which sounded reasonably secure. But 16 phototransistors, 16 switches, and 32 resistors is a lot to wire. Then I realized most of the holes in the card could be dummies.","text_raw":"Now to decide how many phototransistors to use. Sixteen in a 4\u00d74 grid would allow 65,536 possible combinations, which sounded reasonably secure. But 16 phototransistors, 16 switches, and 32 resistors is a lot to wire. Then I realized most of the holes in the card could be dummies.","bullet":"black","level":0},{"text":"Six phototransistors would still provide 64 possible combinations for the lock. I would be the only person who knew which holes were dummies, and which were not.","text_raw":"Six phototransistors would still provide 64 possible combinations for the lock. I would be the only person who knew which holes were dummies, and which were not.","bullet":"black","level":0},{"text":"Next, how to AND 6 phototransistor outputs? This is easy using a 74HC11 chip with three 3-input AND gates. The image shows how they\u2019re chained to give a single output.","text_raw":"Next, how to AND 6 phototransistor outputs? This is easy using a 74HC11 chip with three 3-input AND gates. The image shows how they\u2019re chained to give a single output.","bullet":"black","level":0},{"text":"These phototransistors can be connected directly to the chip because they comply with its requirement for a high input no less than 3.5V and a low input no greater than 1V DC. Use a meter to verify your phototransistors also meet this requirement.","text_raw":"These phototransistors can be connected directly to the chip because they comply with its requirement for a high input no less than 3.5V and a low input no greater than 1V DC. Use a meter to verify your phototransistors also meet this requirement.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57165,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/DYItTDiHZrmeqyAu"}],"number":4},{"title":"Additional Switches","lines":[{"text":"The chip\u2019s output controls a Darlington transistor, which powers the motor (image). The motor stops itself at each end of its travel by opening one of a pair of limit switches, marked S5 and S6. (If you\u2019re unclear about how limit switches work, you\u2019ll find a detailed explanation in my book <em>Make: Electronics<\/em>.)","text_raw":"The chip\u2019s output controls a Darlington transistor, which powers the motor (image). The motor stops itself at each end of its travel by opening one of a pair of limit switches, marked S5 and S6. (If you\u2019re unclear about how limit switches work, you\u2019ll find a detailed explanation in my book ''Make: Electronics''.)","bullet":"black","level":0},{"text":"S4 is a manual DPDT switch, spring-loaded to return to its center-off position. It starts the motor in one direction or the other by bypassing either S5 or S6 through a rectifier diode. If your motor doesn\u2019t respond appropriately, just swap the wires to its inputs.","text_raw":"S4 is a manual DPDT switch, spring-loaded to return to its center-off position. It starts the motor in one direction or the other by bypassing either S5 or S6 through a rectifier diode. If your motor doesn\u2019t respond appropriately, just swap the wires to its inputs.","bullet":"black","level":0},{"text":"The purpose of S7 is to minimize battery drain by keeping the circuit powered down until a key card is inserted. This switch should be positioned so the card closes it when slid fully in.","text_raw":"The purpose of S7 is to minimize battery drain by keeping the circuit powered down until a key card is inserted. This switch should be positioned so the card closes it when slid fully in.","bullet":"black","level":0},{"text":"Because the motor will burn out if it tries to turn the lever to block the deadbolt when the deadbolt has already been retracted, I needed one more fail-safe switch. This is S8, which shuts off the power when the opening deadbolt rubs against it.","text_raw":"Because the motor will burn out if it tries to turn the lever to block the deadbolt when the deadbolt has already been retracted, I needed one more fail-safe switch. This is S8, which shuts off the power when the opening deadbolt rubs against it.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57166,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/EPRKxel6LMkejSJi"}],"number":5},{"title":"More Details","lines":[{"text":"If you use a really small gearmotor rated for 9 or 12V DC, the whole lock can be powered by a 9V battery. An LM7805 voltage regulator will reduce its output to the 5V required by the phototransistors and the chip. The LM7805 datasheet, online, will show you how it should be used in conjunction with a couple of bypass capacitors.","text_raw":"If you use a really small gearmotor rated for 9 or 12V DC, the whole lock can be powered by a 9V battery. An LM7805 voltage regulator will reduce its output to the 5V required by the phototransistors and the chip. The LM7805 datasheet, online, will show you how it should be used in conjunction with a couple of bypass capacitors.","bullet":"black","level":0},{"text":"Because the motor is reversed by changing the polarity of the power, I couldn\u2019t add a protection diode to divert the surge that the motor takes when it starts or stops.","text_raw":"Because the motor is reversed by changing the polarity of the power, I couldn\u2019t add a protection diode to divert the surge that the motor takes when it starts or stops.","bullet":"black","level":0},{"text":"If you find that the power spike disturbs your logic chip, try putting a 0.1 microfarad (\u03bcF) capacitor between the positive power supply to the chip, on pin 14, and the negative supply on pin 7.","text_raw":"If you find that the power spike disturbs your logic chip, try putting a 0.1 microfarad (\u03bcF) capacitor between the positive power supply to the chip, on pin 14, and the negative supply on pin 7.","bullet":"black","level":0},{"text":"The resistors in series with the phototransistors are all 5.6K. To simplify wiring and save space, I used a pair of resistor arrays. Check the datasheet online for the resistor array to see how the resistors are wired inside.","text_raw":"The resistors in series with the phototransistors are all 5.6K. To simplify wiring and save space, I used a pair of resistor arrays. Check the datasheet online for the resistor array to see how the resistors are wired inside.","bullet":"black","level":0},{"text":"You may want to add an LED indicator outside the lock, tied to the output from the Darlington transistor, to let you know that the key has been accepted and the position of the deadbolt can now be changed.","text_raw":"You may want to add an LED indicator outside the lock, tied to the output from the Darlington transistor, to let you know that the key has been accepted and the position of the deadbolt can now be changed.","bullet":"black","level":0},{"text":"Last but not least, you\u2019ll need a light source to activate the phototransistors.","text_raw":"Last but not least, you\u2019ll need a light source to activate the phototransistors.","bullet":"black","level":0},{"text":"Many phototransistors are only sensitive to infrared, but the type I chose will respond to a very broad spectrum, so you should be able to use 3 bright white LEDs to shine down upon the key card. Wire them in series, and you can power them with 9V DC and no additional load resistor.","text_raw":"Many phototransistors are only sensitive to infrared, but the type I chose will respond to a very broad spectrum, so you should be able to use 3 bright white LEDs to shine down upon the key card. Wire them in series, and you can power them with 9V DC and no additional load resistor.","bullet":"black","level":0}],"object":null,"images":[{"imageid":57167,"orderby":1,"text":"http:\/\/guide-images.makeprojects.org\/igi\/6nF4qQsyV3sFDxsL"}],"number":6},{"title":"","lines":[{"text":"As for interfacing the motor with the deadbolt, this mechanical issue is outside the scope of this column, but the setup should look basically like the image in Step 1. I leave it to you to determine the details of fabricating a card slot and mounting it in the door.","text_raw":"As for interfacing the motor with the deadbolt, this mechanical issue is outside the scope of this column, but the setup should look basically like the image in Step 1. I leave it to you to determine the details of fabricating a card slot and mounting it in the door.","bullet":"black","level":0},{"text":"Can this lock be broken? Of course! If someone uses enough brute force, almost any door will yield. Still, the electronic lock will be considerably more secure than a traditional lock containing mechanical tumblers.","text_raw":"Can this lock be broken? Of course! If someone uses enough brute force, almost any door will yield. Still, the electronic lock will be considerably more secure than a traditional lock containing mechanical tumblers.","bullet":"black","level":0}],"object":null,"images":[],"number":7}],"subject":"","summary":"Pick-proof, programmable security without a microcontroller.","time_required":"2 Hours to 2 Days","title":"Key-Card Door Lock","tools":[{"text":"Multimeter and test leads","notes":"","url":"http:\/\/makeprojects.com\/Item\/Multimeter_and_test_leads","thumbnail":""},{"text":"Soldering iron and solder","notes":"","url":"http:\/\/makeprojects.com\/Item\/Soldering_iron_and_solder","thumbnail":""},{"text":"Wire cutters and strippers","notes":"","url":"http:\/\/makeprojects.com\/Item\/Wire_cutters_and_strippers","thumbnail":""}],"type":"project"},"guideid":"3141"}